<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OHT-50 • Center Connection</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600&family=Merriweather:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./oht50_vintage_1.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/flowbite@2.0.0/dist/flowbite.min.js"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
</head>
<body class="min-h-screen">
  <header class="w-full sticky top-0 z-40 border-b" style="border-color: var(--border)">
    <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between">
      <h1 class="text-xl font-bold" style="font-family: var(--font-serif)">Cấu hình kết nối Center</h1>
      <div class="flex items-center gap-2">
        <a class="btn btn-ghost" href="./oht50_overview_1.html"><i data-lucide="arrow-left"></i> <span class="ml-1">Tổng quan</span></a>
        <a href="./fe06_vax_1.html" class="btn btn-ghost hidden sm:inline">Đồ thị v‑a‑x</a>
        <a href="./jobs_monitor_1.html" class="btn btn-ghost hidden sm:inline">Job Monitor</a>
        <a href="./user_settings_1.html" class="btn btn-ghost hidden sm:inline">User</a>
      </div>
    </div>
  </header>

  <main class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6">
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="card p-4 lg:col-span-2">
        <h2 class="text-lg font-semibold mb-3">Thông số kết nối</h2>
        <div class="grid gap-3">
          <label class="text-sm">Base URL<input id="baseUrl" class="w-full px-3 py-2 rounded border" style="border-color: var(--input)" placeholder="http://localhost:8000"/></label>
          <label class="text-sm">WebSocket URL<input id="wsUrl" class="w-full px-3 py-2 rounded border" style="border-color: var(--input)" placeholder="ws://localhost:8000/ws/center"/></label>
          <label class="text-sm">API Key<input id="apiKey" class="w-full px-3 py-2 rounded border" style="border-color: var(--input)" placeholder="***"/></label>
          <label class="text-sm">Heartbeat interval (s)<input id="hb" type="number" class="w-full px-3 py-2 rounded border" style="border-color: var(--input)" value="2"/></label>
          <div class="flex gap-2 justify-end mt-2">
            <button id="btnTest" class="btn btn-ghost" type="button"><i data-lucide="plug"></i> <span class="ml-1">Test Connect</span></button>
            <button id="btnSave" class="btn btn-secondary" type="button"><i data-lucide="save"></i> <span class="ml-1">Lưu</span></button>
            <button id="btnApply" class="btn btn-primary" data-modal-target="modal-apply" data-modal-toggle="modal-apply" type="button"><i data-lucide="check-circle"></i> <span class="ml-1">Áp dụng</span></button>
          </div>
        </div>
      </div>
      <div class="card p-4 lg:col-span-1">
        <h2 class="text-lg font-semibold mb-3">Trạng thái kết nối</h2>
        <div class="grid gap-2 text-sm">
          <div>Center: <span class="badge"><span class="inline-block w-2 h-2 rounded-full" style="background: color-mix(in oklab, var(--chart-4) 80%, black);"></span> Online</span></div>
          <div>Latency: <span id="latency">—</span> ms</div>
          <div>Heartbeat: <span id="hbVal">2</span>s</div>
        </div>
      </div>
    </section>

    <section class="card p-4">
      <h2 class="text-lg font-semibold mb-3">Nhật ký kết nối gần đây</h2>
      <div class="h-56 overflow-y-auto rounded border p-3 text-sm" style="border-color: var(--border); background: var(--card)" id="connLog">
        <!-- logs -->
      </div>
    </section>
  </main>

  <!-- Modal Apply -->
  <div id="modal-apply" class="hidden fixed inset-0 z-50 justify-center items-center w-full h-full">
    <div class="relative p-4 w-full max-w-md">
      <div class="card p-5">
        <h3 class="text-lg font-semibold mb-2">Áp dụng cấu hình</h3>
        <p class="mb-4">Áp dụng cấu hình kết nối mới cho Center? Hành động có thể ảnh hưởng tới phiên hiện tại.</p>
        <div class="flex justify-end gap-2"><button data-modal-hide="modal-apply" class="btn btn-ghost">Hủy</button><button data-modal-hide="modal-apply" class="btn btn-primary">Xác nhận</button></div>
      </div>
    </div>
  </div>

  <script>
    window.lucide && window.lucide.createIcons();
    const log = (m)=>{
      const el = document.getElementById('connLog');
      const row = document.createElement('div');
      row.textContent = new Date().toISOString() + ' • ' + m;
      el.prepend(row);
    };
    document.getElementById('btnTest').addEventListener('click', ()=>{
      log('Test connect to ' + document.getElementById('baseUrl').value);
      document.getElementById('latency').textContent = (Math.random()*20+5).toFixed(1);
    });
    document.getElementById('btnSave').addEventListener('click', ()=> log('Saved configuration'));
    document.getElementById('btnApply').addEventListener('click', ()=> log('Apply requested'));
  </script>
</body>
</html>


